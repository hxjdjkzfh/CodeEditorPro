# Руководство по сборке Android APK

В этом проекте реализовано несколько методов сборки APK файла для Android приложения.

## Режимы сборки

### 1. WebView-режим (по умолчанию)
Создает легкий APK (около 16KB) с минимальной структурой и всеми необходимыми компонентами.
Использует веб-контент из директории `web-app` и упаковывает его в APK.

```bash
./build_android.sh webview
```

Преимущества:
- Небольшой размер APK файла
- Быстрая сборка
- Не требует полного Android SDK
- Надежное создание рабочего APK

### 2. SDK-режим
Пытается использовать полный Android SDK для создания полноценного APK.
Требует корректно настроенный Android SDK и Gradle.

```bash
./build_android.sh sdk
```

Преимущества:
- Полная интеграция с Android экосистемой
- Доступ к нативным API Android
- Возможность настройки приложения через Gradle

### 3. Автоматический режим
Сначала пытается использовать WebView метод, если не получается - 
переключается на полный SDK.

```bash
./build_android.sh auto
```

## Проверка APK файла

После сборки вы можете проверить структуру APK файла с помощью:

```bash
./verify_android_app.sh ./code-editor.apk
```

## Телеграм интеграция

Если у вас настроены секреты `TELEGRAM_TOKEN` и `TELEGRAM_TO`, 
APK файл будет автоматически отправлен в указанный чат/канал.

```bash
# Отправка APK вручную
python3 send_to_telegram.py ./code-editor.apk "Новая версия приложения"
```

## Решение проблем

### APK не устанавливается с ошибкой "Parse Error"

Возможные причины:
1. Устройство не поддерживает минимальную версию Android (API 24+)
2. APK файл поврежден или не имеет необходимых компонентов
3. Проблемы с подписью APK

Решение:
```bash
# Исправить структуру APK
python3 fix_apk.py

# Или создать APK заново
./build_android.sh webview
```

### Ошибка сборки через Gradle/Android SDK

Если сборка через полный Android SDK не работает, используйте WebView метод:

```bash
./build_android.sh webview
```

## Структура проекта

```
- build_android.sh          - Основной скрипт сборки
- build_webview_app.sh      - Скрипт создания WebView APK
- create_full_apk.py        - Скрипт для создания APK через Android SDK
- web-app/                  - Веб-приложение (HTML, CSS, JS)
- android-webview-app/      - Структура Android проекта
- fix_apk.py                - Инструмент для исправления APK структуры
- verify_android_app.sh     - Инструмент проверки APK
- send_to_telegram.py       - Утилита отправки APK в Telegram
```